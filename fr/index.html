<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Votre Avis sur Siena Paris</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Montserrat:wght@400;500;600&display=swap');
        :root{--brand-color:#BF5B3F;--background-color:#FDFBF5;--surface-color:#FFFFFF;--text-primary:#2C2C2C;--text-secondary:#737373;--border-color:#EAE0D5;--font-serif:'Cormorant Garamond',serif;--font-sans:'Montserrat',sans-serif;}
        @keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
        body{font-family:var(--font-sans);background-color:var(--background-color);color:var(--text-primary);margin:0;padding:20px;display:flex;justify-content:center;align-items:center;min-height:100vh;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
        .review-container{background-color:var(--surface-color);border-radius:16px;padding:28px 32px;box-shadow:0 10px 50px -10px rgba(133,93,67,.2);max-width:480px;width:100%;text-align:center;box-sizing:border-box;border:1px solid var(--border-color);animation:fadeIn .8s ease-out;}
        .logo-container img{width:180px;height:auto;margin-bottom:10px}
        h1{font-family:var(--font-serif);font-size:2.2rem;margin-bottom:12px;margin-top:10px}
        p{font-size:1rem;line-height:1.6;color:var(--text-secondary);margin-bottom:32px}
        .tag-section{margin-bottom:28px;text-align:left}
        .tag-section h3{font-family:var(--font-serif);font-size:1.4rem;margin-bottom:16px;color:var(--brand-color)}
        .tag-group{display:flex;flex-wrap:wrap;gap:12px}
        .tag-group input[type=checkbox],.tag-group input[type=radio]{position:absolute;opacity:0;width:0;height:0}
        .tag-group label{background-color:#F7F1E9;color:var(--text-secondary);padding:10px 18px;border-radius:10px;cursor:pointer;font-size:.9rem;font-weight:500;transition:all .3s ease;border:1px solid var(--border-color);user-select:none}
        .tag-group input:checked+label{background-color:var(--brand-color);color:#fff;transform:translateY(-2px);box-shadow:0 4px 15px rgba(191,91,63,.25);border-color:var(--brand-color)}
        textarea{width:100%;box-sizing:border-box;padding:14px;border:1px solid var(--border-color);border-radius:12px;font-family:var(--font-sans);font-size:1rem;min-height:140px;resize:vertical;background-color:#FDFBF5;color:var(--text-primary);margin-bottom:16px}
        .button{background-color:var(--brand-color);color:#fff;border:1px solid var(--brand-color);padding:16px;border-radius:12px;font-size:1rem;font-weight:600;cursor:pointer;width:100%;transition:all .3s ease;display:block;text-decoration:none;box-sizing:border-box;box-shadow:0 4px 15px rgba(0,0,0,.1)}
        .button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(191,91,63,.3)}
        .button.secondary{background:var(--surface-color);color:var(--brand-color);border-color:var(--border-color);margin-top:12px}
        .button.secondary:hover{border-color:var(--brand-color)}
        #google-btn{margin-top:12px}
        .hidden{display:none !important}
        .loader-container{display:flex;flex-direction:column;align-items:center;gap:15px;margin:20px auto}
        .loader{width:40px;height:40px;border:4px solid var(--border-color);border-left-color:var(--brand-color);border-radius:50%;animation:spin 1s linear infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        .dropdown-container{margin-top:15px;max-height:0;overflow:hidden;transition:max-height .5s ease-in-out,margin-top .5s ease-in-out}
        .dropdown-container.visible{max-height:100px}
        select#birthday_details{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border-color);background-color:#F7F1E9;font-family:var(--font-sans);font-size:.9rem;color:var(--text-primary);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23BF5B3F%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22/%3E%3C/svg%3E');background-repeat:no-repeat;background-position:right 15px top 50%;background-size:.65em auto}
        footer{margin-top:30px;padding-top:20px;border-top:1px solid var(--border-color);font-size:.8rem;color:var(--text-secondary)}
        .dish-subcategory{font-weight:600;font-size:.95rem;color:var(--text-secondary);margin-top:20px;margin-bottom:12px;border-bottom:1px solid var(--border-color);padding-bottom:5px}
        .dish-subcategory:first-child{margin-top:0}
        
        /* --- NOUVEAUX STYLES POUR LA ROULETTE --- */
        .roulette-wrapper{padding:10px 0; text-align:center;}
        .roulette-container{position:relative;width:300px;height:300px;margin:20px auto;border-radius:50%;border:8px solid #EAE0D5;box-shadow:0 0 20px rgba(0,0,0,0.15);overflow:hidden;}
        .pointer{position:absolute;top:50%;left:-20px;transform:translateY(-50%);width:0;height:0;border-top:20px solid transparent;border-bottom:20px solid transparent;border-right:30px solid var(--brand-color);z-index: 10;}
        .wheel{width:100%;height:100%;border-radius:50%;position:relative;transition:transform 7s cubic-bezier(0.3, 1, 0.4, 1);transform:rotate(0deg);}
        .wheel-segment{position:absolute;width:50%;height:50%;transform-origin:100% 100%;overflow:hidden;}
        /* Positionne chaque segment de 22.5deg (360/16) */
        .wheel-segment:nth-child(1){transform:rotate(0deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(2){transform:rotate(22.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(3){transform:rotate(45deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(4){transform:rotate(67.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(5){transform:rotate(90deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(6){transform:rotate(112.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(7){transform:rotate(135deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(8){transform:rotate(157.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(9){transform:rotate(180deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(10){transform:rotate(202.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(11){transform:rotate(225deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(12){transform:rotate(247.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(13){transform:rotate(270deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(14){transform:rotate(292.5deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(15){transform:rotate(315deg) skewY(-67.5deg);}
        .wheel-segment:nth-child(16){transform:rotate(337.5deg) skewY(-67.5deg);}
        
        .segment-content{position:absolute;left:-100%;width:200%;height:200%;text-align:center;transform:skewY(67.5deg) rotate(11.25deg);padding-top:20px;color:var(--text-primary);font-weight:600;font-size:0.8rem;}
        
        /* Couleurs des segments en alternance */
        .wheel-segment:nth-child(odd) { background-color: #F7F1E9; }
        .wheel-segment:nth-child(even) { background-color: #FFFFFF; }
        
        /* Couleurs spéciales pour les prix */
        .wheel-segment.perdu .segment-content { color: var(--text-secondary); }
        .wheel-segment.perdu { background-color: #E0E0E0; }
        .wheel-segment.gros-lot { background-color: var(--brand-color); }
        .wheel-segment.gros-lot .segment-content { color: white; font-weight: bold; }
        
        .prize-result{margin-top:20px;padding:15px;border-radius:10px;background-color:#F7F1E9;border:1px solid var(--border-color);animation:fadeIn 1s;}
        .prize-result h3{margin:0;font-family:var(--font-serif);color:var(--brand-color);}
        .prize-result p{margin:5px 0 0;font-size:1rem;color:var(--text-primary);}
    </style>
</head>
<body>
    <div class="review-container">
        <div class="logo-container">
            <a href="/"><img src="/assets/logosiena-1.png" alt="Logo Siena Paris - Retour à l'accueil"></a>
        </div>
        <h1>Une soirée mémorable ?</h1>
        <p>Votre avis est la touche finale de votre expérience. Partagez ce qui a enchanté vos sens pour nous aider à rester fidèles à l'esprit de la Toscane.</p>
        <form id="review-form">
            <div class="tag-section"><h3>Une occasion spéciale ?</h3><div class="tag-group" data-category="reason_for_visit"><input type="radio" id="event_birthday" name="event" value="un anniversaire"><label for="event_birthday">Anniversaire</label><input type="radio" id="event_romantic" name="event" value="un dîner romantique"><label for="event_romantic">Dîner romantique</label><input type="radio" id="event_friends" name="event" value="un dîner entre amis"><label for="event_friends">Dîner entre amis</label><input type="radio" id="event_visit" name="event" value="une simple visite" checked><label for="event_visit">Simple visite</label></div><div id="birthday_details_container" class="dropdown-container"><select id="birthday_details" name="birthday_details" data-category="birthday_details"><option value="" disabled selected>C'était l'anniversaire de qui ?</option><option value="de mon père">Père</option><option value="de ma mère">Mère</option><option value="de mon mari">Mari</option><option value="de ma femme">Femme</option><option value="de mon fils">Fils</option><option value="de ma fille">Fille</option><option value="d'un(e) ami(e)">Ami(e)</option></select></div></div>
            <div class="tag-section"><h3>Le service de Kewan</h3><p style="font-size: 0.9rem; margin-top: -10px; margin-bottom: 20px;">Sélectionnez jusqu'à 3 options.</p><div class="tag-group" data-category="service_kewan"><input type="checkbox" id="tag_service_1" value="attentionné"><label for="tag_service_1">Attentionné</label><input type="checkbox" id="tag_service_2" value="souriant et chaleureux"><label for="tag_service_2">Souriant</label><input type="checkbox" id="tag_service_3" value="professionnel"><label for="tag_service_3">Professionnel</label><input type="checkbox" id="tag_service_4" value="efficace et rapide"><label for="tag_service_4">Efficace</label><input type="checkbox" id="tag_service_5" value="de très bon conseil"><label for="tag_service_5">De bon conseil</label><input type="checkbox" id="tag_service_6" value="discret"><label for="tag_service_6">Discret</label></div></div>
            <div class="tag-section" id="dishes-section-limiter"><h3>Les saveurs qui vous ont marqué</h3><p style="font-size: 0.9rem; margin-top: -10px; margin-bottom: 20px;">Choisissez jusqu'à 6 de vos coups de cœur.</p><h4 class="dish-subcategory">Antipasti & Crudo</h4><div class="tag-group" data-category="liked_dishes"><input type="checkbox" id="dish_burrata" value="la Burrata al tartufo"><label for="dish_burrata">Burrata al Tartufo</label><input type="checkbox" id="dish_arancini" value="les Arancini au caviar"><label for="dish_arancini">Arancini</label><input type="checkbox" id="dish_calamari" value="les Calamari Fritti"><label for="dish_calamari">Calamari Fritti</label><input type="checkbox" id="dish_tartare" value="le Tartare di tonno"><label for="dish_tartare">Tartare di Tonno</label></div><h4 class="dish-subcategory">Pâtes</h4><div class="tag-group" data-category="liked_dishes"><input type="checkbox" id="dish_ravioli" value="les Ravioli al tartufo"><label for="dish_ravioli">Ravioli al Tartufo</label><input type="checkbox" id="dish_linguine" value="les Linguine all'astice"><label for="dish_linguine">Linguine all’Astice</label><input type="checkbox" id="dish_tagliolini" value="les Tagliolini gamberi e caviale"><label for="dish_tagliolini">Tagliolini Gamberi & Caviale</label></div><h4 class="dish-subcategory">Viandes & Poissons</h4><div class="tag-group" data-category="liked_dishes"><input type="checkbox" id="dish_milanese" value="la Milanese 'Orecchie di elefante'"><label for="dish_milanese">La Milanese</label><input type="checkbox" id="dish_wagyu" value="le Wagyu de Kagoshima"><label for="dish_wagyu">Wagyu de Kagoshima</label><input type="checkbox" id="dish_gamberoni" value="les Gamberoni alla griglia"><label for="dish_gamberoni">Gamberoni alla Griglia</label></div><h4 class="dish-subcategory">Pizze</h4><div class="tag-group" data-category="liked_dishes"><input type="checkbox" id="dish_pizza_margherita" value="la pizza Margherita"><label for="dish_pizza_margherita">Margherita</label><input type="checkbox" id="dish_pizza_diavola" value="la pizza Diavola"><label for="dish_pizza_diavola">Diavola</label><input type="checkbox" id="dish_pizza_italiana" value="la pizza Italiana"><label for="dish_pizza_italiana">Italiana</label><input type="checkbox" id="dish_pizza_tartufo" value="la pizza Al Tartufo"><label for="dish_pizza_tartufo">Al Tartufo</label></div><h4 class="dish-subcategory">Douceurs</h4><div class="tag-group" data-category="liked_dishes"><input type="checkbox" id="dish_tiramisu" value="le Tiramisù classique"><label for="dish_tiramisu">Tiramisù</label><input type="checkbox" id="dish_sainthonore" value="le Siena Saint-Honoré"><label for="dish_sainthonore">Siena Saint-Honoré</label><input type="checkbox" id="dish_pavlova" value="la Pavlova aux fruits rouges"><label for="dish_pavlova">Pavlova</label><input type="checkbox" id="dish_ananas" value="l'Ananas rôti au miel"><label for="dish_ananas">Ananas Rôti</label></div></div>
            <div class="tag-section"><h3>L'atmosphère du lieu</h3><p style="font-size: 0.9rem; margin-top: -10px; margin-bottom: 20px;">Sélectionnez jusqu'à 3 options.</p><div class="tag-group" data-category="atmosphere"><input type="checkbox" id="tag_atmo_1" value="la décoration chic"><label for="tag_atmo_1">La Décoration</label><input type="checkbox" id="tag_atmo_2" value="l'ambiance musicale live"><label for="tag_atmo_2">La Musique Live</label><input type="checkbox" id="tag_atmo_3" value="l'énergie festive"><label for="tag_atmo_3">L'Énergie Festive</label><input type="checkbox" id="tag_atmo_4" value="l'éclairage tamisé et intime"><label for="tag_atmo_4">L'Éclairage Intime</label><input type="checkbox" id="tag_atmo_5" value="le confort des assises"><label for="tag_atmo_5">Le Confort</label><input type="checkbox" id="tag_atmo_6" value="parfait pour les photos"><label for="tag_atmo_6">Idéal pour les photos</label></div></div>
            <button type="submit" class="button" id="generate-btn">Générer mon avis</button>
        </form>
        
        <div id="loader" class="loader-container hidden">
            <div class="loader"></div>
            <span id="loader-text">Création en cours...</span>
        </div>

        <div id="result-area" class="hidden">
            <p><strong>Merci ! Votre avis est prêt.</strong></p>
            <p style="font-size: 0.9rem; margin-bottom: 20px;">Publiez-le sur Google, puis revenez ici pour tourner notre roue de la chance et tenter de gagner une surprise !</p>
            <textarea id="review-text" readonly></textarea>
            <button id="copy-btn" class="button secondary">Copier le texte</button>
            <a href="https://search.google.com/local/writereview?placeid=ChIJIdvGkX5v5kcRQ1FTWUnyJxo" target="_blank" id="google-btn" class="button">Publier mon avis sur Google</a>
        </div>

        <div id="roulette-section" class="roulette-wrapper hidden">
            <h3>Tentez votre chance !</h3>
            <div class="roulette-container">
                <div class="pointer"></div>
                <div class="wheel" id="wheel">
                    </div>
            </div>
            <button id="spin-btn" class="button">Lancer la roue</button>
            <div id="prize-result-container" class="hidden"></div>
        </div>

        <footer>
            &copy; <span id="copyright-year"></span> KwnLnrd. Tous droits réservés.
        </footer>
    </div>

    <script>
        // --- SCRIPT COMPLET AVEC LA NOUVELLE LOGIQUE DE ROULETTE ---

        // --- SÉLECTION DES ÉLÉMENTS DU DOM ---
        const reviewForm = document.getElementById('review-form');
        const resultArea = document.getElementById('result-area');
        const googleBtn = document.getElementById('google-btn');
        const rouletteSection = document.getElementById('roulette-section');
        const wheel = document.getElementById('wheel');
        const spinBtn = document.getElementById('spin-btn');
        const prizeResultContainer = document.getElementById('prize-result-container');
        const generateBtn=document.getElementById("generate-btn"),loaderContainer=document.getElementById("loader"),loaderText=document.getElementById("loader-text"),reviewText=document.getElementById("review-text"),copyBtn=document.getElementById("copy-btn"),eventRadios=document.querySelectorAll('input[name="event"]'),birthdayDetailsContainer=document.getElementById("birthday_details_container"),birthdayDetailsSelect=document.getElementById("birthday_details"),loadingMessages=["Contact de notre assistant créatif...","Analyse de votre soirée mémorable...","L'inspiration est en chemin...","Finalisation de la rédaction..."];let messageInterval;const limitConfig={service_kewan:3,atmosphere:3,"dishes-section-limiter":6};
        
        // --- GESTION DES LIMITES DE SÉLECTION (inchangée)---
        reviewForm.addEventListener("change",e=>{if("checkbox"!==e.target.type)return;const t=e.target.closest("#dishes-section-limiter"),a=e.target.closest(".tag-section");let n,i;if(t?(n="dishes-section-limiter",i=limitConfig[n]):a){const e=a.querySelector(".tag-group")?.dataset.category;limitConfig[e]&&(n=e,i=limitConfig[n])}if(n&&i){const t=document.getElementById(n)||a;t.querySelectorAll('input[type="checkbox"]:checked').length>i&&(e.target.checked=!1,alert(`Vous ne pouvez sélectionner que ${i} options maximum dans cette catégorie.`))}});
        eventRadios.forEach(e=>{e.addEventListener("change",e=>{e.target.id==="event_birthday"?birthdayDetailsContainer.classList.add("visible"):birthdayDetailsContainer.classList.remove("visible")})});
        
        // --- GESTION DE LA SOUMISSION DU FORMULAIRE (inchangée) ---
        reviewForm.addEventListener("submit",async e=>{e.preventDefault();const t=[];document.querySelectorAll('input[type="checkbox"]:checked, input[type="radio"]:checked').forEach(e=>{t.push({category:e.closest(".tag-group").dataset.category,value:e.value})});if(0===t.length)return void alert("Veuillez sélectionner au moins une option pour décrire votre expérience.");document.getElementById("event_birthday").checked&&birthdayDetailsSelect.value&&t.push({category:birthdayDetailsSelect.dataset.category,value:`pour l'anniversaire ${birthdayDetailsSelect.value}`});reviewForm.classList.add("hidden");loaderContainer.classList.remove("hidden");let a=0;loaderText.textContent=loadingMessages[a],messageInterval=setInterval(()=>{a=(a+1)%loadingMessages.length,loaderText.textContent=loadingMessages[a]},2500);try{const e=await realApiCall(t);reviewText.value=e,resultArea.classList.remove("hidden")}catch(e){console.error("Erreur lors de la génération :",e),alert("Une erreur est survenue. Veuillez réessayer."),reviewForm.classList.remove("hidden")}finally{clearInterval(messageInterval),loaderContainer.classList.add("hidden")}});
        copyBtn.addEventListener("click",()=>{navigator.clipboard.writeText(reviewText.value).then(()=>{copyBtn.textContent="Copié !",setTimeout(()=>{copyBtn.textContent="Copier le texte"},2e3)})});

        // --- NOUVELLE LOGIQUE POUR LA ROULETTE ---

        // Configuration des prix (logique) et des segments (visuel)
        const prizes = [
            { id: 'champagne', text: 'UNE BOUTEILLE DE CHAMPAGNE', weight: 1 },
            { id: 'perdu', text: 'PERDU', weight: 81 },
            { id: 'cafe', text: 'UN CAFÉ OFFERT', weight: 4 },
            { id: 'soft', text: 'UN SOFT OFFERT', weight: 4 },
            { id: 'entree', text: 'UNE ENTRÉE OFFERTE', weight: 3 },
            { id: 'dessert', text: 'UN DESSERT OFFERT', weight: 3 },
            { id: 'cocktail', text: 'UN COCKTAIL OFFERT', weight: 2 },
            { id: 'vin', text: 'UN VERRE DE VIN OFFERT', weight: 2 }
        ];

        // 16 segments visuels, avec les paires en face (i et i+8)
        const visualSegments = [
            { id: 'gros-lot', text: 'CHAMPAGNE' }, // 0
            { id: 'perdu', text: 'Perdu' },         // 1
            { id: 'cocktail', text: 'Cocktail' },   // 2
            { id: 'perdu', text: 'Perdu' },         // 3
            { id: 'vin', text: 'Verre de Vin' },    // 4
            { id: 'entree', text: 'Entrée' },       // 5
            { id: 'dessert', text: 'Dessert' },     // 6
            { id: 'perdu', text: 'Perdu' },         // 7
            { id: 'cafe', text: 'Café' },           // 8 (en face de Champagne)
            { id: 'soft', text: 'Soft' },           // 9 (en face de perdu)
            { id: 'cocktail', text: 'Cocktail' },   // 10 (en face de cocktail)
            { id: 'cafe', text: 'Café' },           // 11 (en face de perdu)
            { id: 'vin', text: 'Verre de Vin' },    // 12 (en face de vin)
            { id: 'entree', text: 'Entrée' },       // 13 (en face d'entrée')
            { id: 'dessert', text: 'Dessert' },     // 14 (en face de dessert)
            { id: 'soft', text: 'Soft' }            // 15 (en face de perdu)
        ];

        // Créer les segments de la roue dynamiquement
        visualSegments.forEach((segment, index) => {
            const segmentEl = document.createElement('div');
            segmentEl.className = 'wheel-segment';
            if (segment.id === 'gros-lot') segmentEl.classList.add('gros-lot');
            if (segment.id === 'perdu') segmentEl.classList.add('perdu');
            
            const contentEl = document.createElement('div');
            contentEl.className = 'segment-content';
            contentEl.textContent = segment.text;
            segmentEl.appendChild(contentEl);
            wheel.appendChild(segmentEl);
        });
        
        // Tirage au sort pondéré
        function getWeightedRandomPrize() {
            const weightedList = [];
            prizes.forEach(prize => {
                for (let i = 0; i < prize.weight; i++) {
                    weightedList.push(prize);
                }
            });
            return weightedList[Math.floor(Math.random() * weightedList.length)];
        }

        spinBtn.addEventListener('click', () => {
            spinBtn.disabled = true;
            prizeResultContainer.classList.add('hidden'); // Cache le résultat précédent
            
            const wonPrize = getWeightedRandomPrize();
            
            // Trouve tous les segments visuels correspondant au prix gagné
            const possibleSegments = visualSegments.map((seg, i) => seg.id.includes(wonPrize.id) ? i : -1).filter(i => i !== -1);
            const targetSegmentIndex = possibleSegments[Math.floor(Math.random() * possibleSegments.length)];
            
            const segmentAngle = 360 / 16;
            const randomOffset = (Math.random() * 0.8 + 0.1) * segmentAngle; // Pour atterrir au milieu du segment
            const targetAngle = (targetSegmentIndex * segmentAngle) + randomOffset;
            
            const extraSpins = 6 * 360; // Pour une belle animation longue
            const finalAngle = extraSpins + (360 - targetAngle); // On tourne dans le sens inverse du texte

            wheel.style.transform = `rotate(${finalAngle}deg)`;

            setTimeout(() => {
                prizeResultContainer.innerHTML = `
                    <div class="prize-result">
                        <h3>Félicitations !</h3>
                        <p>${wonPrize.text}</p>
                        <p style="font-size:0.8rem; margin-top:10px;">Montrez cet écran à Kewan pour recevoir votre cadeau.</p>
                    </div>
                `;
                prizeResultContainer.classList.remove('hidden');
                spinBtn.style.display = 'none'; // Cache le bouton après le premier tour
            }, 7200); // Doit être plus long que la durée de la transition CSS
        });

        googleBtn.addEventListener('click', () => {
            resultArea.classList.add('hidden');
            rouletteSection.classList.remove('hidden');
        });

        async function realApiCall(tags) {
            const apiUrl = 'https://siena-api.onrender.com/generate-review'; 
            const lang = 'fr';
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ lang: lang, tags: tags }),
            });
            if (!response.ok) throw new Error(`Erreur HTTP: ${response.status}`);
            const data = await response.json();
            return data.review;
        }

        document.getElementById('copyright-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>