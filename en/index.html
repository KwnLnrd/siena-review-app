<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Feedback on Siena Paris</title>
    <style>
        /* --- Font Import & Design Variables (Color Palette) --- */
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Montserrat:wght@400;500;600&display=swap');

        :root {
            --brand-color: #BF5B3F;      /* Tuscan Sienna / Terracotta */
            --background-color: #FDFBF5; /* Cream / Off-white background */
            --surface-color: #FFFFFF;
            --text-primary: #2C2C2C;      /* Dark Brown / Near-black */
            --text-secondary: #737373;
            --border-color: #EAE0D5;
            --font-serif: 'Cormorant Garamond', serif;
            --font-sans: 'Montserrat', sans-serif;
        }

        /* --- General Styling --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--background-color);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Main Structure --- */
        .review-container {
            background-color: var(--surface-color);
            border-radius: 16px;
            padding: 28px 32px;
            box-shadow: 0 10px 50px -10px rgba(133, 93, 67, 0.2);
            max-width: 480px;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease-out;
        }

        .logo-container img {
            width: 180px;
            height: auto;
            margin-bottom: 20px;
        }
        
        /* --- Text --- */
        h1 {
            font-family: var(--font-serif);
            font-size: 2.2rem;
            margin-bottom: 12px;
        }

        p {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: 32px;
        }

        /* --- Selection Sections (Tags) --- */
        .tag-section {
            margin-bottom: 28px;
            text-align: left;
        }

        .tag-section h3 {
            font-family: var(--font-serif);
            font-size: 1.4rem;
            margin-bottom: 16px;
            color: var(--brand-color);
        }
        
        .tag-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .tag-group input[type="checkbox"], 
        .tag-group input[type="radio"] {
            display: none; /* Hide native buttons */
        }

        .tag-group label {
            background-color: #F7F1E9;
            color: var(--text-secondary);
            padding: 10px 18px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }
        
        .tag-group input:checked + label {
            background-color: var(--brand-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(191, 91, 63, 0.25);
            border-color: var(--brand-color);
        }

        /* --- Result Area (After generation) --- */
        textarea {
            width: 100%;
            box-sizing: border-box;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-family: var(--font-sans);
            font-size: 1rem;
            min-height: 140px;
            resize: vertical;
            background-color: #FDFBF5;
            color: var(--text-primary);
            margin-bottom: 16px;
        }
        
        /* --- Button Styles --- */
        .button {
            background-color: var(--brand-color);
            color: white;
            border: 1px solid var(--brand-color);
            padding: 16px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: block;
            text-decoration: none;
            box-sizing: border-box;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(191, 91, 63, 0.3);
        }
        
        .button.secondary {
            background: var(--surface-color);
            color: var(--brand-color);
            border-color: var(--border-color);
            margin-top: 12px;
        }
        
        .button.secondary:hover {
            border-color: var(--brand-color);
        }
        
        /* --- Utilities --- */
        .hidden { 
            display: none; 
        }

        .loader {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-left-color: var(--brand-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body lang="en">

    <div class="review-container">
        
        <div class="logo-container">
            <img src="https://restaurantsiena.com/wp-content/uploads/2023/05/vert.png" alt="Siena Paris Logo">
        </div>

        <h1>A memorable evening?</h1>
        <p>Your feedback is the finishing touch to your experience. Share what delighted your senses to help us stay true to the spirit of Tuscany.</p>

        <form id="review-form">
            
            <div class="tag-section">
                <h3>A special occasion?</h3>
                <div class="tag-group" data-category="The reason for my visit was">
                    <input type="radio" id="event1" name="event" value="a birthday"><label for="event1">Birthday</label>
                    <input type="radio" id="event2" name="event" value="a romantic dinner"><label for="event2">Romantic dinner</label>
                    <input type="radio" id="event3" name="event" value="a business meal"><label for="event3">Business meal</label>
                    <input type="radio" id="event4" name="event" value="just visiting" checked><label for="event4">Just visiting</label>
                </div>
            </div>

            <div class="tag-section">
                <h3>Kewan's service</h3>
                <div class="tag-group" data-category="Kewan's service was">
                    <input type="checkbox" id="tag1" value="attentive"><label for="tag1">Attentive</label>
                    <input type="checkbox" id="tag2" value="warm and friendly"><label for="tag2">Warm & friendly</label>
                    <input type="checkbox" id="tag3" value="full of great advice"><label for="tag3">Great advice</label>
                    <input type="checkbox" id="tag4" value="efficient and thoughtful"><label for="tag4">Efficient</label>
                </div>
            </div>

            <div class="tag-section">
                <h3>The flavors that stood out</h3>
                <div class="tag-group" data-category="I particularly enjoyed">
                    <input type="checkbox" id="tag5" value="the Pici Cacio e Pepe"><label for="tag5">Pici Cacio e Pepe</label>
                    <input type="checkbox" id="tag6" value="the homemade Truffle Ravioli"><label for="tag6">Truffle Ravioli</label>
                    <input type="checkbox" id="tag7" value="the tender Grilled Octopus"><label for="tag7">Grilled Octopus</label>
                    <input type="checkbox" id="tag8" value="the generous Milanese cutlet"><label for="tag8">Milanese cutlet</label>
                    <input type="checkbox" id="tag9" value="the Truffle Pizza"><label for="tag9">Truffle Pizza</label>
                    <input type="checkbox" id="tag10" value="the classic Tiramisù"><label for="tag10">The Tiramisù</label>
                </div>
            </div>

            <button type="submit" class="button" id="generate-btn">Draft my review</button>
        </form>

        <div id="loader" class="loader hidden"></div>
        <div id="result-area" class="hidden">
            <textarea id="review-text" readonly></textarea>
            <button id="copy-btn" class="button secondary">Copy text</button>
            <a href="[YOUR GOOGLE REVIEW LINK HERE]" target="_blank" id="google-btn" class="button">Publish review on Google</a>
        </div>
    </div>

    <script>
        const reviewForm = document.getElementById('review-form');
        const generateBtn = document.getElementById('generate-btn');
        const loader = document.getElementById('loader');
        const resultArea = document.getElementById('result-area');
        const reviewText = document.getElementById('review-text');
        const copyBtn = document.getElementById('copy-btn');

        // Event listener for the form submission
        reviewForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevents the page from reloading
            
            const selectedTags = [];
            const checkedInputs = document.querySelectorAll('input[type="checkbox"]:checked, input[type="radio"]:checked');
            
            if (checkedInputs.length === 0) {
                alert('Please select at least one option to describe your experience.');
                return;
            }

            // Builds an array with the client's selections
            checkedInputs.forEach(input => {
                selectedTags.push({ 
                    category: input.parentElement.dataset.category, 
                    value: input.value 
                });
            });

            // Manages the display to show the loader
            reviewForm.classList.add('hidden');
            loader.classList.remove('hidden');
            
            // Calls the function that contacts our Python server
            try {
                const generatedReview = await realApiCall(selectedTags);
                reviewText.value = generatedReview; // Displays the generated review
                loader.classList.add('hidden');
                resultArea.classList.remove('hidden'); // Shows the result area
            } catch (error) {
                console.error('Error during generation:', error);
                alert('An error occurred. Please try again.');
                // In case of an error, we show the form again
                loader.classList.add('hidden');
                reviewForm.classList.remove('hidden');
            }
        });

        // Logic for the copy text button
        copyBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(reviewText.value).then(() => {
                copyBtn.textContent = 'Copied!';
                setTimeout(() => { 
                    copyBtn.textContent = 'Copy text'; 
                }, 2000);
            });
        });

        // Function that sends the data to the backend server
        async function realApiCall(tags) {
            
            // ===================================================================
            // REQUIRED CHANGE 1: Your API URL
            // Replace the URL below with the address of your API deployed on Render.
            // ===================================================================
            const apiUrl = 'https://siena-api.onrender.com/generate-review'; 
            
            // ===================================================================
            // REQUIRED CHANGE 2: Language Code
            // For each translated version of this page, change the language code.
            // 'en' for English, 'es' for Spanish, 'de' for German, etc.
            // ===================================================================
            const lang = 'en';

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ lang: lang, tags: tags }),
            });

            if (!response.ok) {
                throw new Error(`HTTP Error: ${response.status}`);
            }

            const data = await response.json();
            return data.review;
        }
    </script>
</body>
</html>